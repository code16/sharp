import{d as R,r as P,a1 as T,W as f,Z as C,a2 as F,a3 as j,a4 as I,c as h,w as s,$ as L,o,u as e,J as W,i as E,a as b,j as g,V as z,b as n,t as l,k as V,a5 as D,A as i,_ as c,F as u,a0 as B}from"./sharp-DKdd8iDn.js";import{_ as J}from"./Title.vue_vue_type_script_setup_true_lang-BOZhoXKY.js";import{_ as K}from"./PageBreadcrumb.vue_vue_type_script_setup_true_lang-BW9HLQwu.js";const M={class:"@container"},O={class:"flex gap-4"},H=R({__name:"Form",props:{form:{},breadcrumb:{},errors:{},cancelUrl:{},endpointUrl:{}},setup($){var w,S;const t=$,{entityKey:x,instanceId:v}=P().params,a=new T(t.form,x,v),p=f(!1),_=f(!1),y=f("");C(()=>a.errors,()=>{Object.keys(a.errors).length===0&&(_.value=!1)},{deep:!0});function k(){B.post(t.endpointUrl,a.data,{onStart:()=>{p.value=!0},onFinish:()=>{p.value=!1},onError:()=>{a.onError(t.errors),_.value=!0,y.value=t.errors.error}})}const m=f(t.form.layout.tabs.map(r=>F(r.title)).find(r=>new URLSearchParams(location.search).get("tab")==r)??F(((S=(w=t.form.layout.tabs)==null?void 0:w[0])==null?void 0:S.title)??"")),d=j("el");return C(m,()=>{d.value&&d.value.getBoundingClientRect().top<56&&d.value.scrollIntoView();const r=new URL(location.href);t.form.layout.tabs.length>1&&(r.searchParams.set("tab",m.value),B.replace({url:r.href,preserveState:!0,preserveScroll:!0}))},{immediate:!0}),(r,U)=>{const A=I("SharpForm");return o(),h(L,null,{breadcrumb:s(()=>[e(W)("sharp.display_breadcrumb")?(o(),h(K,{key:0,breadcrumb:r.breadcrumb},null,8,["breadcrumb"])):E("",!0)]),default:s(()=>[b(J,{breadcrumb:r.breadcrumb},null,8,["breadcrumb"]),g("div",M,[g("div",{class:z(e(a).pageAlert?"mt-4":"mt-6 @3xl:mt-10"),ref_key:"el",ref:d},[b(A,{form:e(a),"show-error-alert":_.value,"error-alert-message":y.value,tab:m.value,"onUpdate:tab":U[0]||(U[0]=N=>m.value=N),onSubmit:k},{title:s(()=>[n(l(e(a).title),1)]),footer:s(()=>[g("div",O,[b(e(V),{variant:"outline","as-child":""},{default:s(()=>[b(e(D),{href:t.cancelUrl},{default:s(()=>[e(a).canEdit?(o(),i(u,{key:0},[n(l(e(c)("sharp::action_bar.form.cancel_button")),1)],64)):(o(),i(u,{key:1},[n(l(e(c)("sharp::action_bar.form.back_button")),1)],64))]),_:1},8,["href"])]),_:1}),e(a).canEdit?(o(),h(e(V),{key:0,style:{"min-width":"6.5em"},disabled:e(a).isUploading||p.value,onClick:k},{default:s(()=>[e(a).isUploading?(o(),i(u,{key:0},[n(l(e(c)("sharp::action_bar.form.submit_button.pending.upload")),1)],64)):e(v)||e(a).config.isSingle?(o(),i(u,{key:1},[n(l(e(c)("sharp::action_bar.form.submit_button.update")),1)],64)):(o(),i(u,{key:2},[n(l(e(c)("sharp::action_bar.form.submit_button.create")),1)],64))]),_:1},8,["disabled"])):E("",!0)])]),_:1},8,["form","show-error-alert","error-alert-message","tab"])],2)])]),_:1})}}});export{H as default};
